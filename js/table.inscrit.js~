
/*
 * Editor client script for DB table inscrit
 * Automatically generated by http://editor.datatables.net/generator
 */

(function($){

$(document).ready(function() {
	var editor = new $.fn.dataTable.Editor( {
		"ajaxUrl": "php/table.inscrit.php",
		"domTable": "#inscrit",
		"fields": [
			{
				"label": "Famille",
				"name": "famille",
				"type": "text"
			},
			{
				"label": "Pr\u00e9nom",
				"name": "prenom",
				"type": "text"
			},
			{
				"label": "Adresse",
				"name": "adresse",
				"type": "text"
			},
			{
				"label": "Cp",
				"name": "cp",
				"type": "text"
			},
			{
				"label": "T\u00e9l",
				"name": "tel",
				"type": "text"
			},
			{
				"label": "Email",
				"name": "email",
				"type": "text"
			},
			{
				"label": "Ecole pr\u00e9c\u00e9dente",
				"name": "ecole_prec",
				"default": "Aucune",
				"type": "select",
				"ipOpts": [
					{
						"label": "Aucune",
						"value": "Aucune"
					},
					{
						"label": "Hanned",
						"value": "Hanned"
					},
					{
						"label": "Autres",
						"value": "Autres"
					}
				]
			},
			{
				"label": "Classe d\u00e9sir\u00e9e",
				"name": "classe_desiree",
				"type": "select",
				"ipOpts": [
					{
						"label": "CP",
						"value": "CP"
					},
					{
						"label": "CE1",
						"value": "CE1"
					},
					{
						"label": "CE2",
						"value": "CE2"
					},
					{
						"label": "CM1",
						"value": "CM1"
					},
					{
						"label": "CM2",
						"value": "CM2"
					}
				]
			},
			{
				"label": "Fratrie",
				"name": "fraterie",
				"default": "Non",
				"type": "select",
				"ipOpts": [
					{
						"label": "Oui",
						"value": "Oui"
					},
					{
						"label": "Non",
						"value": "Non"
					}
				]
			},
			{
				"label": "Implication",
				"name": "implication",
				"default": " - ",
				"type": "select",
				"ipOpts": [
					{
						"label": "INTENSE",
						"value": "INTENSE"
					},
					{
						"label": "MOYEN",
						"value": "MOYEN"
					},
					{
						"label": "FAIBLE",
						"value": "FAIBLE"
					},
					{
						"label": " - ",
						"value": " - "
					}
				]
			},
			{
				"label": "Inscriptions multiple",
				"name": "multi_inscrit",
				"type": "text"
			},
			{
				"label": "Date de Rdv",
				"name": "dt_rdv",
				"type": "date"
			},
			{
				"label": "Evaluation",
				"name": "eval",
				"default":"0",
				"type": "text"
			}
		]
	} );

	var oTable = $('#inscrit').dataTable( {
		"iDisplayLength": 25,
		"oLanguage": {
			    "oPaginate": {
				                   "sFirst":    "Premier",
				                   "sPrevious": "Précédent",
				                   "sNext":     "Suivant",
				                   "sLast":     "Dernier" 
				                  },
			    "sProcessing": "Traitement ...",
			    "sLengthMenu": "Afficher _MENU_ inscriptions par page",
			    "sZeroRecords": "Aucune inscription",
			    "sInfo": "Affichage _START_ à _END_ sur _TOTAL_ inscriptions",
			    "sInfoPostFix": "",
			    "sSearch": "Filtrer:"
        		},
        	"bSortClasses": false,
        	"bStateSave": true,
        	"bAutoWidth": false,	
		"sDom": "<'row-fluid'<'span6'T><'span6'f>r>t<'row-fluid'<'span6'i><'span6'p>>",
		"sAjaxSource": "php/table.inscrit.php",
		"aoColumns": [
			{
				"mData": "famille"
			},
			{
				"mData": "prenom"
			},
			{
				"mData": "adresse"
			},
			{
				"mData": "cp"
			},
			{
				"mData": "tel"
			},
			{
				"mData": "email"
			},
			{
				"mData": "ecole_prec"
			},
			{
				"mData": "classe_desiree"
			},
			{
				"mData": "fraterie"
			},
			{
				"mData": "multi_inscrit"
			},
			{
				"mData": "implication"
			},
			{
				"mData": "dt_rdv"
			},
			{
				"mData": "eval"
			},
			{
				"mData": function ( source, type, val ) {
					var pt = 0;
					if (source.ecole_prec === 'Hanned'){
					   pt = 15000;
					}
					if (source.implication === 'INTENSE'){
					   pt += 15000;					
					} else if (source.implication === 'MOYEN'){
					   pt += 7000;					
					}  else if (source.implication === 'FAIBLE'){
					   pt += 3000;					
					}
					if (source.fraterie === 'Oui'){
					   pt += 1000;					
					}
					pt += Math.abs(source.eval-10)*600; 
					return pt;
				      }
			}
		],
		"oTableTools": {
			"sRowSelect": "single",
			"aButtons": [
				{ "sExtends": "editor_create", "editor": editor, "sButtonText": "Nouvelle inscription", "sButtonClass": "btn-large" },
				{ "sExtends": "editor_edit",   "editor": editor, "sButtonText": "Modifier inscription", "sButtonClass": "btn-large"  },
				{ "sExtends": "editor_remove", "editor": editor, "sButtonText": "Supprimer inscription", "sButtonClass": "btn-large"  },
				{ "sExtends": "print", "sButtonText": "Imprimer", "sButtonClass": "btn-large"  }
			]
		}
	} );
	$('.classe_desiree').click( function () {
			var param = $(this).text();				
			if(param === 'Tous'){
				param = '';
			}			
			oTable.fnFilter(param, 7);
			$("li").removeClass("active");
			$(this).parent().addClass('active');
		} );
} );

}(jQuery));

